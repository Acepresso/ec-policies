////
This content is automatically generated from a template, see
https://github.com/hacbs-contract/ec-policies/tree/main/docsrc
Do not edit it manually.
////

:numbered:

= Pipeline Policy

These rules are applied to Tekton pipeline definitions.

== Basic Rules

[#unexpected_kind]
=== link:#unexpected_kind[Input data has unexpected kind]

A sanity check to confirm the input data has the kind "Pipeline"

* Rule type: [rule-type-indicator deny]#FAILURE#
* Failure message: `Unexpected kind '%s'`
* Short name: `unexpected_kind`
* https://github.com/hacbs-contract/ec-policies/blob/main/policy/pipeline/basic.rego#L19[Source, window="_blank"]

== Required Tasks Rules

[#required_tasks]
=== link:#required_tasks[Pipeline does not include all required check tasks]

Every build pipeline is expected to contain a set of checks and tests that
are required by the Enterprise Contract. This rule confirms that the pipeline
definition includes all the expected tasks.

The matching is done using the taskRef name rather than the pipeline task name.

The required task refs are:

----
clamav-scan
conftest-clair
get-clair-scan
sanity-inspect-image
sanity-label-check
sast-go
sast-java-sec-check
----

* Rule type: [rule-type-indicator deny]#FAILURE#
* Failure message: `Required tasks %s were not found in the pipeline's task list`
* Short name: `required_tasks`
* https://github.com/hacbs-contract/ec-policies/blob/main/policy/pipeline/required_tasks.rego#L32[Source, window="_blank"]

