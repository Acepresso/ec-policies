#
# If `data.config.policy.collection` is set then the include/exclude
# lists defined here will be used to determine which rules are applied
# and which are skipped.
#
rule_collections:

  default:
    description: Includes every rule
    include:
    - "*"
    exclude: []

  # List of requirements: https://slsa.dev/spec/v0.1/requirements
  slsa1:
    description: Includes policy rules required to meet SLSA Level 1
    include:
    - slsa_provenance_available
    - slsa_build_scripted_build
    exclude: []

  # List of requirements: https://slsa.dev/spec/v0.1/requirements
  slsa2:
    description: >-
      Includes policy rules required to meet SLSA Level 2.
      Special attention must be given to two requirements
      which are not covered by the policy rules in this
      collection. The first is "Provenance - Authenticated"
      which is expected to be performed when fetching the
      attestation via cosign or ec-cli. The second requirement
      is "Provenace - Service Generated" which is a little
      more complex to verify. By meeting both the
      "Provenance - Authenticated" AND "Build - Build Service"
      requirements, we can have some confidence that this
      requirement is met since Chains is a service that
      generates signed attestations with data obtained from
      the build service (Tekton Pipelines).
    include:
    - slsa_source_version_controlled
    - slsa_build_scripted_build
    - slsa_build_build_service
    - slsa_provenance_available
    exclude: []

  # List of requirements: https://slsa.dev/spec/v0.1/requirements
  slsa3:
    description: >-
      Includes policy rules required to meet SLSA Level 3. This is
      currently a work in progress and functionally the same as the
      slsa2 collection.
    include:
    - slsa_source_version_controlled
    - slsa_build_scripted_build
    - slsa_build_build_service
    - slsa_provenance_available
    exclude: []
